# CSVインポートガイド

各サービスからデータをエクスポートし、Google Sheetsにインポートする手順を説明します。

---

## 📋 目次

1. [かんたん介護からのデータエクスポート](#かんたん介護からのデータエクスポート)
2. [ノウビーからのデータエクスポート](#ノウビーからのデータエクスポート)
3. [ハローボックスからのデータエクスポート](#ハローボックスからのデータエクスポート)
4. [Google Sheetsへのインポート](#google-sheetsへのインポート)
5. [推奨データ形式](#推奨データ形式)
6. [トラブルシューティング](#トラブルシューティング)

---

## かんたん介護からのデータエクスポート

### 手順

1. **かんたん介護にログイン**
   - ブラウザでかんたん介護を開く
   - ユーザー名とパスワードでログイン

2. **エクスポート機能を探す**
   - メニューから「データ出力」または「エクスポート」を選択
   - 「CSV出力」または「Excel出力」を選択

3. **出力範囲を設定**
   - 出力したい期間を選択(例: 過去1ヶ月)
   - 出力したいデータ種類を選択(例: 訪問記録、実績記録)

4. **ダウンロード**
   - 「出力」または「ダウンロード」ボタンをクリック
   - CSVファイルがダウンロードされます

### 推奨ファイル名

- `kantan_kaigo_YYYYMMDD.csv` (例: `kantan_kaigo_20260203.csv`)

---

## ノウビーからのデータエクスポート

### 手順

1. **ノウビーにログイン**
   - ブラウザでノウビーを開く
   - ログイン情報を入力

2. **データ出力画面を開く**
   - メニューから「実績管理」または「データ出力」を選択

3. **出力設定**
   - 出力期間を選択
   - 出力形式を「CSV」に設定

4. **ダウンロード**
   - 「出力」ボタンをクリック
   - CSVファイルを保存

### 推奨ファイル名

- `nouby_YYYYMMDD.csv` (例: `nouby_20260203.csv`)

---

## ハローボックスからのデータエクスポート

### 手順

ハローボックスにエクスポート機能がない場合は、以下の方法で対応してください:

#### 方法1: 手動コピー&ペースト

1. ハローボックスでデータを表示
2. 必要なデータを選択してコピー
3. Google Sheetsに直接ペースト

#### 方法2: スクリーンショット

1. 重要な情報をスクリーンショット
2. Google Driveにアップロード
3. Google Sheetsにリンクを貼る

---

## Google Sheetsへのインポート

### 新規スプレッドシート作成

1. **Google Sheetsを開く**
   - [https://sheets.google.com](https://sheets.google.com)にアクセス
   - 「空白」をクリックして新規作成

2. **スプレッドシート名を設定**
   - 「無題のスプレッドシート」をクリック
   - 「介護統合データ」など分かりやすい名前に変更

### CSVファイルのインポート

#### 手順

1. **シートを作成**
   - 左下の「+」ボタンをクリック
   - シート名を「かんたん介護」に変更

2. **CSVをインポート**
   - メニューから「ファイル」→「インポート」を選択
   - 「アップロード」タブをクリック
   - CSVファイルをドラッグ&ドロップ

3. **インポート設定**
   - インポート場所: 「新しいシートに挿入」
   - 区切り文字: 「自動検出」
   - テキストを数値、日付、数式に変換: ✅ チェック

4. **「データをインポート」をクリック**

5. **シート名を変更**
   - インポートされたシートを右クリック
   - 「名前を変更」→「かんたん介護」

### 複数のCSVをインポート

同じ手順で、ノウビー、ハローボックスのデータも別シートとしてインポートします:

- シート1: かんたん介護
- シート2: ノウビー
- シート3: ハローボックス
- シート4: シフト表(手動入力)

---

## 推奨データ形式

### 基本ルール

1. **1行目はヘッダー**
   - 項目名を記載(例: 日付、利用者、サービス、スタッフ)

2. **日付形式**
   - `YYYY-MM-DD` 形式を推奨(例: 2026-02-03)
   - または `YYYY/MM/DD` 形式

3. **文字コード**
   - UTF-8を推奨

4. **空白セル**
   - 空白セルがあっても問題ありません

### サンプルデータ

#### かんたん介護

| 日付 | 利用者 | サービス | スタッフ | 時間 | 備考 |
|------|--------|---------|---------|------|------|
| 2026-02-03 | 佐藤花子 | 訪問介護 | 山田太郎 | 10:00-11:00 | 問題なし |
| 2026-02-03 | 田中一郎 | デイサービス | 鈴木次郎 | 09:00-17:00 | 体調良好 |

#### ノウビー

| 日付 | 利用者 | サービス | 実績 | 請求 | 備考 |
|------|--------|---------|------|------|------|
| 2026-02-03 | 田中一郎 | 居宅介護 | 完了 | 済 | - |
| 2026-02-03 | 佐藤花子 | 重度訪問 | 完了 | 済 | - |

#### シフト表

| 日付 | スタッフ | シフト | 開始 | 終了 | 備考 |
|------|---------|--------|------|------|------|
| 2026-02-03 | 山田太郎 | 早番 | 07:00 | 16:00 | - |
| 2026-02-03 | 鈴木次郎 | 遅番 | 11:00 | 20:00 | - |

---

## トラブルシューティング

### Q1. CSVファイルが文字化けする

**原因:** 文字コードが異なる

**解決方法:**
1. CSVファイルをメモ帳で開く
2. 「ファイル」→「名前を付けて保存」
3. 文字コードを「UTF-8」に変更して保存
4. 再度Google Sheetsにインポート

### Q2. 日付が正しく表示されない

**原因:** 日付形式が認識されていない

**解決方法:**
1. Google Sheetsで日付列を選択
2. メニューから「表示形式」→「数字」→「日付」を選択

### Q3. データが1つのセルにまとまってしまう

**原因:** 区切り文字が正しく認識されていない

**解決方法:**
1. インポート時に「区切り文字」を手動で選択
2. 「カンマ」または「タブ」を選択

### Q4. ダッシュボードにデータが表示されない

**原因:** シート名が正しくない、またはデータ形式が不正

**チェック項目:**
- ✅ シート名にスペースや特殊文字が含まれていないか
- ✅ 1行目がヘッダーになっているか
- ✅ データが2行目以降に入っているか
- ✅ APIキーとスプレッドシートIDが正しいか

---

## 定期的な更新方法

### 手動更新

1. 各サービスから最新データをエクスポート
2. Google Sheetsの該当シートを開く
3. 古いデータを削除
4. 新しいCSVをインポート
5. ダッシュボードアプリで「🔄 更新」ボタンをクリック

### 推奨頻度

- **毎日更新**: シフト表、当日の実績
- **週1回更新**: 週次レポート
- **月1回更新**: 月次集計データ

---

## サンプルテンプレート

サンプルテンプレートは `templates/` フォルダにあります:

- `sample_kantan_kaigo.csv` - かんたん介護用テンプレート
- `sample_nouby.csv` - ノウビー用テンプレート
- `sample_shift.csv` - シフト表テンプレート

これらをコピーして使用してください。

---

## まとめ

1. 各サービスからCSVエクスポート
2. Google Sheetsに別シートとしてインポート
3. ダッシュボードアプリで自動表示
4. 定期的に更新

この方法で、すべてのデータを一元管理できます!

---

## サポート

問題が解決しない場合は、以下を確認してください:

- Google Sheets APIが有効化されているか
- スプレッドシートが「リンクを知っている全員」に共有されているか
- ブラウザのコンソールにエラーが表示されていないか

それでも解決しない場合は、スクリーンショットを添えてサポートに問い合わせてください。
